{
  "meta": {
    "framework": "Next.js",
    "version": "2025.1",
    "type": "security",
    "intendedFor": [
      "MCP",
      "config-driven-analysis"
    ],
    "description": "Security rules for next-js generated from config",
    "generatedFrom": "config/simplified-security-rules.json",
    "autoGenerated": true
  },
  "securityRules": [
    {
      "id": "xss-prevention",
      "title": "Prevent XSS Vulnerabilities",
      "intent": "security rule: Avoid using dangerouslySetInnerHTML. React/Next.js escapes content by default. Use DOMPurify for user-generated HTML.",
      "scope": "code",
      "severity": "critical",
      "enabled": true,
      "category": "security",
      "detection": {
        "patterns": [
          "dangerouslySetInnerHTML",
          "innerHTML",
          "eval\\s*\\(",
          "Function\\s*\\("
        ]
      },
      "recommendation": "Avoid using dangerouslySetInnerHTML. React/Next.js escapes content by default. Use DOMPurify for user-generated HTML.",
      "codeExample": {
        "bad": "return <div dangerouslySetInnerHTML={{ __html: userInput }} />;",
        "good": "return <div>{userInput}</div>; // React/Next.js auto-escapes"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "high",
      "detectionExplanation": "Detects prevent xss vulnerabilities patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Avoid using dangerouslySetInnerHTML. React/Next.js escapes content by default. Use DOMPurify for user-generated HTML.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "no-hardcoded-secrets",
      "title": "No Hardcoded Secrets",
      "intent": "security rule: Store all secrets in environment variables. Use NEXT_PUBLIC_ prefix for client-side vars. Never commit secrets.",
      "scope": "code",
      "severity": "critical",
      "enabled": true,
      "category": "security",
      "detection": {
        "patterns": [
          "password\\s*[=:]\\s*['\\\"]",
          "api[_-]?key\\s*[=:]\\s*['\\\"]",
          "secret\\s*[=:]\\s*['\\\"]",
          "token\\s*[=:]\\s*['\\\"]"
        ],
        "excludePatterns": [
          "*.test.*",
          "*.spec.*",
          "mock*"
        ]
      },
      "recommendation": "Store all secrets in environment variables. Use NEXT_PUBLIC_ prefix for client-side vars. Never commit secrets.",
      "codeExample": {
        "bad": "const apiKey = 'sk-1234567890abcdef';",
        "good": "const apiKey = process.env.API_KEY; // Server-side\nconst publicKey = process.env.NEXT_PUBLIC_API_KEY; // Client-side"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "high",
      "detectionExplanation": "Detects no hardcoded secrets patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Store all secrets in environment variables. Use NEXT_PUBLIC_ prefix for client-side vars. Never commit secrets.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "server-only-secrets",
      "title": "Keep Secrets Server-Side Only",
      "intent": "security rule: Never expose server-side secrets to client. Use Server Components or API routes for sensitive operations.",
      "scope": "project",
      "severity": "critical",
      "enabled": true,
      "category": "security",
      "detection": {
        "fileGlobs": [
          "package.json"
        ]
      },
      "recommendation": "Never expose server-side secrets to client. Use Server Components or API routes for sensitive operations.",
      "codeExample": {
        "bad": "'use client'; const secret = process.env.SECRET_KEY; // Exposed to client!",
        "good": "// In Server Component: const secret = process.env.SECRET_KEY; // Safe"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "high",
      "detectionExplanation": "Detects keep secrets server-side only patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Never expose server-side secrets to client. Use Server Components or API routes for sensitive operations.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "no-eval",
      "title": "Avoid eval() and Dynamic Code Execution",
      "intent": "security rule: Never use eval() or Function() constructor. Use JSON.parse or data-driven approaches instead.",
      "scope": "code",
      "severity": "critical",
      "enabled": true,
      "category": "security",
      "detection": {
        "patterns": [
          "\\beval\\s*\\(",
          "\\bFunction\\s*\\(",
          "setTimeout\\s*\\(['\\\"]",
          "setInterval\\s*\\(['\\\"]"
        ]
      },
      "recommendation": "Never use eval() or Function() constructor. Use JSON.parse or data-driven approaches instead.",
      "codeExample": {
        "bad": "const result = eval(userInput);",
        "good": "const result = JSON.parse(userInput);"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "high",
      "detectionExplanation": "Detects avoid eval() and dynamic code execution patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Never use eval() or Function() constructor. Use JSON.parse or data-driven approaches instead.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "secure-api-calls",
      "title": "Secure API Communication",
      "intent": "security rule: Always use HTTPS for external API calls. Use Next.js API routes for sensitive operations.",
      "scope": "code",
      "severity": "high",
      "enabled": true,
      "category": "security",
      "detection": {
        "patterns": [
          "fetch\\s*\\(\\s*['\\\"]http://",
          "axios\\s*\\(\\s*['\\\"]http://"
        ]
      },
      "recommendation": "Always use HTTPS for external API calls. Use Next.js API routes for sensitive operations.",
      "codeExample": {
        "bad": "fetch('http://api.example.com/data');",
        "good": "fetch('/api/data'); // Use Next.js API route"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "medium",
      "detectionExplanation": "Detects secure api communication patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Always use HTTPS for external API calls. Use Next.js API routes for sensitive operations.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "csrf-protection-server-actions",
      "title": "CSRF Protection for Server Actions",
      "intent": "security rule: Next.js Server Actions have built-in CSRF protection. Ensure you're using them correctly with 'use server' directive.",
      "scope": "project",
      "severity": "high",
      "enabled": true,
      "category": "security",
      "detection": {
        "fileGlobs": [
          "package.json"
        ]
      },
      "recommendation": "Next.js Server Actions have built-in CSRF protection. Ensure you're using them correctly with 'use server' directive.",
      "codeExample": {
        "bad": "// Client-side POST without protection",
        "good": "'use server'; export async function submitForm(formData) { /* protected */ }"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "medium",
      "detectionExplanation": "Detects csrf protection for server actions patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Next.js Server Actions have built-in CSRF protection. Ensure you're using them correctly with 'use server' directive.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "input-validation",
      "title": "Input Validation in Server Actions",
      "intent": "security rule: Validate all inputs in Server Actions and API routes. Use Zod or similar validation libraries.",
      "scope": "project",
      "severity": "high",
      "enabled": true,
      "category": "security",
      "detection": {
        "fileGlobs": [
          "package.json"
        ]
      },
      "recommendation": "Validate all inputs in Server Actions and API routes. Use Zod or similar validation libraries.",
      "codeExample": {
        "bad": "const data = formData.get('email');",
        "good": "const schema = z.object({ email: z.string().email() }); const data = schema.parse(formData);"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "medium",
      "detectionExplanation": "Detects input validation in server actions patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Validate all inputs in Server Actions and API routes. Use Zod or similar validation libraries.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "dependency-vulnerabilities",
      "title": "Check for Vulnerable Dependencies",
      "intent": "security rule: Regularly run npm audit and update vulnerable packages. Use dependabot for automated updates.",
      "scope": "project",
      "severity": "high",
      "enabled": true,
      "category": "security",
      "detection": {
        "fileGlobs": [
          "package.json"
        ]
      },
      "recommendation": "Regularly run npm audit and update vulnerable packages. Use dependabot for automated updates.",
      "codeExample": {
        "bad": "// Outdated vulnerable package version",
        "good": "// Run: npm update && npm audit fix"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "medium",
      "detectionExplanation": "Detects check for vulnerable dependencies patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Regularly run npm audit and update vulnerable packages. Use dependabot for automated updates.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "secure-headers",
      "title": "HTTP Security Headers",
      "intent": "security rule: Configure security headers in next.config.js: CSP, X-Frame-Options, X-Content-Type-Options, Strict-Transport-Security.",
      "scope": "project",
      "severity": "high",
      "enabled": true,
      "category": "security",
      "detection": {
        "fileGlobs": [
          "package.json"
        ]
      },
      "recommendation": "Configure security headers in next.config.js: CSP, X-Frame-Options, X-Content-Type-Options, Strict-Transport-Security.",
      "codeExample": {
        "bad": "// No security headers in next.config.js",
        "good": "// next.config.js: async headers() { return [{ source: '/:path*', headers: [...securityHeaders] }] }"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "medium",
      "detectionExplanation": "Detects http security headers patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Configure security headers in next.config.js: CSP, X-Frame-Options, X-Content-Type-Options, Strict-Transport-Security.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "authentication-checks",
      "title": "Authentication & Authorization",
      "intent": "security rule: Verify authentication in Server Components, Server Actions, and API routes. Use middleware for route protection.",
      "scope": "project",
      "severity": "critical",
      "enabled": true,
      "category": "security",
      "detection": {
        "fileGlobs": [
          "package.json"
        ]
      },
      "recommendation": "Verify authentication in Server Components, Server Actions, and API routes. Use middleware for route protection.",
      "codeExample": {
        "bad": "export default async function Page() { return <SecretData />; }",
        "good": "export default async function Page() { const session = await getSession(); if (!session) redirect('/login'); }"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "high",
      "detectionExplanation": "Detects authentication & authorization patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Verify authentication in Server Components, Server Actions, and API routes. Use middleware for route protection.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "middleware-security",
      "title": "Secure Middleware Configuration",
      "intent": "security rule: Use Next.js middleware for authentication checks and security headers. Ensure proper matcher configuration.",
      "scope": "project",
      "severity": "high",
      "enabled": true,
      "category": "security",
      "detection": {
        "fileGlobs": [
          "package.json"
        ]
      },
      "recommendation": "Use Next.js middleware for authentication checks and security headers. Ensure proper matcher configuration.",
      "codeExample": {
        "bad": "// No authentication middleware",
        "good": "// middleware.ts: export function middleware(request) { const token = request.cookies.get('token'); if (!token) return NextResponse.redirect('/login'); }"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "medium",
      "detectionExplanation": "Detects secure middleware configuration patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Use Next.js middleware for authentication checks and security headers. Ensure proper matcher configuration.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    }
  ]
}