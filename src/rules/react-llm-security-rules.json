{
  "meta": {
    "framework": "React",
    "version": "2025.1",
    "type": "security",
    "intendedFor": [
      "MCP",
      "config-driven-analysis"
    ],
    "description": "Security rules for react generated from config",
    "generatedFrom": "config/simplified-security-rules.json",
    "autoGenerated": true
  },
  "securityRules": [
    {
      "id": "xss-prevention",
      "title": "Prevent XSS Vulnerabilities",
      "intent": "security rule: Avoid using dangerouslySetInnerHTML. React escapes content by default. Use DOMPurify for user-generated HTML.",
      "scope": "code",
      "severity": "critical",
      "enabled": true,
      "category": "security",
      "detection": {
        "patterns": [
          "dangerouslySetInnerHTML",
          "innerHTML",
          "eval\\s*\\(",
          "Function\\s*\\("
        ]
      },
      "recommendation": "Avoid using dangerouslySetInnerHTML. React escapes content by default. Use DOMPurify for user-generated HTML.",
      "codeExample": {
        "bad": "return <div dangerouslySetInnerHTML={{ __html: userInput }} />;",
        "good": "return <div>{userInput}</div>; // React auto-escapes"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "high",
      "detectionExplanation": "Detects prevent xss vulnerabilities patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Avoid using dangerouslySetInnerHTML. React escapes content by default. Use DOMPurify for user-generated HTML.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "no-hardcoded-secrets",
      "title": "No Hardcoded Secrets",
      "intent": "security rule: Store all secrets in environment variables. Never commit secrets to version control.",
      "scope": "code",
      "severity": "critical",
      "enabled": true,
      "category": "security",
      "detection": {
        "patterns": [
          "password\\s*[=:]\\s*['\\\"]",
          "api[_-]?key\\s*[=:]\\s*['\\\"]",
          "secret\\s*[=:]\\s*['\\\"]",
          "token\\s*[=:]\\s*['\\\"]"
        ],
        "excludePatterns": [
          "*.test.*",
          "*.spec.*",
          "mock*"
        ]
      },
      "recommendation": "Store all secrets in environment variables. Never commit secrets to version control.",
      "codeExample": {
        "bad": "const apiKey = 'sk-1234567890abcdef';",
        "good": "const apiKey = process.env.REACT_APP_API_KEY;"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "high",
      "detectionExplanation": "Detects no hardcoded secrets patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Store all secrets in environment variables. Never commit secrets to version control.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "no-eval",
      "title": "Avoid eval() and Dynamic Code Execution",
      "intent": "security rule: Never use eval() or Function() constructor. Use JSON.parse or data-driven approaches instead.",
      "scope": "code",
      "severity": "critical",
      "enabled": true,
      "category": "security",
      "detection": {
        "patterns": [
          "\\beval\\s*\\(",
          "\\bFunction\\s*\\(",
          "setTimeout\\s*\\(['\\\"]",
          "setInterval\\s*\\(['\\\"]"
        ]
      },
      "recommendation": "Never use eval() or Function() constructor. Use JSON.parse or data-driven approaches instead.",
      "codeExample": {
        "bad": "const result = eval(userInput);",
        "good": "const result = JSON.parse(userInput);"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "high",
      "detectionExplanation": "Detects avoid eval() and dynamic code execution patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Never use eval() or Function() constructor. Use JSON.parse or data-driven approaches instead.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "secure-api-calls",
      "title": "Secure API Communication",
      "intent": "security rule: Always use HTTPS for API calls. Include proper authentication headers.",
      "scope": "code",
      "severity": "high",
      "enabled": true,
      "category": "security",
      "detection": {
        "patterns": [
          "fetch\\s*\\(\\s*['\\\"]http://",
          "axios\\s*\\(\\s*['\\\"]http://"
        ]
      },
      "recommendation": "Always use HTTPS for API calls. Include proper authentication headers.",
      "codeExample": {
        "bad": "fetch('http://api.example.com/data');",
        "good": "fetch('https://api.example.com/data', {\n  headers: { 'Authorization': `Bearer ${token}` }\n});"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "medium",
      "detectionExplanation": "Detects secure api communication patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Always use HTTPS for API calls. Include proper authentication headers.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "csrf-protection",
      "title": "CSRF Token Validation",
      "intent": "security rule: Implement CSRF tokens for state-changing operations. Validate tokens on the server.",
      "scope": "project",
      "severity": "high",
      "enabled": true,
      "category": "security",
      "detection": {
        "fileGlobs": [
          "package.json"
        ]
      },
      "recommendation": "Implement CSRF tokens for state-changing operations. Validate tokens on the server.",
      "codeExample": {
        "bad": "// Form without CSRF protection",
        "good": "// Include CSRF token in forms: <input name='csrf' value={csrfToken} />"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "medium",
      "detectionExplanation": "Detects csrf token validation patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Implement CSRF tokens for state-changing operations. Validate tokens on the server.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "input-validation",
      "title": "Input Validation",
      "intent": "security rule: Validate and sanitize all user inputs on both client and server side.",
      "scope": "project",
      "severity": "high",
      "enabled": true,
      "category": "security",
      "detection": {
        "fileGlobs": [
          "package.json"
        ]
      },
      "recommendation": "Validate and sanitize all user inputs on both client and server side.",
      "codeExample": {
        "bad": "const userEmail = request.body.email;",
        "good": "const userEmail = sanitize(request.body.email); // Validate format"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "medium",
      "detectionExplanation": "Detects input validation patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Validate and sanitize all user inputs on both client and server side.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "dependency-vulnerabilities",
      "title": "Check for Vulnerable Dependencies",
      "intent": "security rule: Regularly run npm audit and update vulnerable packages. Use dependabot for automated updates.",
      "scope": "project",
      "severity": "high",
      "enabled": true,
      "category": "security",
      "detection": {
        "fileGlobs": [
          "package.json"
        ]
      },
      "recommendation": "Regularly run npm audit and update vulnerable packages. Use dependabot for automated updates.",
      "codeExample": {
        "bad": "// Outdated vulnerable package version",
        "good": "// Run: npm update && npm audit fix"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "medium",
      "detectionExplanation": "Detects check for vulnerable dependencies patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Regularly run npm audit and update vulnerable packages. Use dependabot for automated updates.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "secure-headers",
      "title": "HTTP Security Headers",
      "intent": "security rule: Implement security headers: CSP, X-Frame-Options, X-Content-Type-Options, Strict-Transport-Security.",
      "scope": "project",
      "severity": "high",
      "enabled": true,
      "category": "security",
      "detection": {
        "fileGlobs": [
          "package.json"
        ]
      },
      "recommendation": "Implement security headers: CSP, X-Frame-Options, X-Content-Type-Options, Strict-Transport-Security.",
      "codeExample": {
        "bad": "// No security headers",
        "good": "// Add to next.config.js: headers with CSP and other security headers"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "medium",
      "detectionExplanation": "Detects http security headers patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Implement security headers: CSP, X-Frame-Options, X-Content-Type-Options, Strict-Transport-Security.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "sql-injection",
      "title": "SQL Injection Prevention",
      "intent": "security rule: Use parameterized queries or ORM libraries. Never concatenate user input into SQL strings.",
      "scope": "code",
      "severity": "critical",
      "enabled": true,
      "category": "security",
      "detection": {
        "patterns": [
          "query\\s*\\(\\s*['\\\"].*\\+.*['\\\"]",
          "execute\\s*\\(\\s*['\\\"].*\\+.*['\\\"]"
        ]
      },
      "recommendation": "Use parameterized queries or ORM libraries. Never concatenate user input into SQL strings.",
      "codeExample": {
        "bad": "db.query(`SELECT * FROM users WHERE id = ${userId}`);",
        "good": "db.query('SELECT * FROM users WHERE id = ?', [userId]);"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "high",
      "detectionExplanation": "Detects sql injection prevention patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Use parameterized queries or ORM libraries. Never concatenate user input into SQL strings.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    },
    {
      "id": "authentication-checks",
      "title": "Authentication & Authorization",
      "intent": "security rule: Verify authentication before accessing protected resources. Check user permissions for authorization.",
      "scope": "project",
      "severity": "critical",
      "enabled": true,
      "category": "security",
      "detection": {
        "fileGlobs": [
          "package.json"
        ]
      },
      "recommendation": "Verify authentication before accessing protected resources. Check user permissions for authorization.",
      "codeExample": {
        "bad": "if (user) { /* allow access */ }",
        "good": "if (user && user.role === 'admin') { /* allow access */ }"
      },
      "confidence": "high",
      "falsePositives": "low",
      "performanceImpact": "low",
      "easeOfRemediation": "high",
      "detectionExplanation": "Detects authentication & authorization patterns in code to ensure compliance.",
      "remediationExplanation": "Fix this by: Verify authentication before accessing protected resources. Check user permissions for authorization.",
      "references": [],
      "relatedVulnerabilities": [],
      "detectionLimitations": "May not catch all instances in complex or obfuscated code.",
      "additionalNotes": "Keep dependencies updated and follow security best practices.",
      "examplesOfExploits": []
    }
  ]
}