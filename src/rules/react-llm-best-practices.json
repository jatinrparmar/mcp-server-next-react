{
  "meta": {
    "framework": "React",
    "version": "2025.1",
    "type": "best-practices",
    "intendedFor": ["LLMs", "GitHub Copilot", "documentation-reference"],
    "description": "Comprehensive best practices guide for LLMs to reference when working with React applications"
  },
  "rules": [
    {
      "id": "react-functional-components-only",
      "title": "Use Functional Components Only",
      "intent": "Modern React development uses functional components with hooks instead of class components.",
      "scope": "component",
      "severity": "error",
      "detection": {
        "patterns": ["class.*extends.*React\\.Component", "class.*extends.*Component"]
      },
      "recommendation": "Convert class components to functional components using hooks (useState, useEffect, etc.).",
      "references": ["https://react.dev/reference/react"]
    },
    {
      "id": "react-hooks-at-top-level",
      "title": "Call Hooks at Top Level",
      "intent": "Hooks must be called at the top level of the component, not inside loops, conditions, or nested functions.",
      "scope": "component",
      "severity": "error",
      "detection": {
        "patterns": ["if\\(.*\\).*useState", "for\\(.*\\).*useState", "useState.*if", "useEffect.*if"]
      },
      "recommendation": "Move hooks outside of conditionals, loops, and nested functions. Call them directly in the component body."
    },
    {
      "id": "react-19-features",
      "title": "Adopt React 19 Hooks",
      "description": "Prefer React 19 features like useActionState, useOptimistic, and useFormStatus where they simplify UI updates",
      "severity": "medium",
      "rule": "react-19-features"
    },
    {
      "id": "avoid-localstorage",
      "title": "Avoid localStorage for app state or secrets",
      "description": "Do not store app state or sensitive data in localStorage/sessionStorage",
      "severity": "high",
      "rule": "avoid-localstorage"
    },
    {
      "id": "centralized-error-handling",
      "title": "Centralize API error handling",
      "description": "Wrap API calls with try/catch and funnel errors to a shared handler/logger",
      "severity": "medium",
      "rule": "centralized-error-handling"
    },
    {
      "id": "avoid-secrets-in-code",
      "title": "Avoid hardcoded secrets",
      "description": "Never commit tokens, passwords, or API keys in code; use validated environment variables",
      "severity": "critical",
      "rule": "avoid-secrets-in-code"
    },
    {
      "id": "env-validation",
      "title": "Validate environment variables",
      "intent": "Validate env vars with schemas and separate client-safe vs server-only",
      "scope": "config",
      "severity": "error",
      "detection": {
        "fileGlobs": ["env.ts", "env.js", "env.mjs", "config/env.ts"],
        "patterns": ["zod", "@t3-oss/env-nextjs", "envsafe", "zodios"]
      },
      "recommendation": "Use Zod or @t3-oss/env-nextjs to validate environment variables; never expose secrets to client"
    },
    {
      "id": "form-validation-schemas",
      "title": "Use schema-based form validation",
      "intent": "All forms should validate inputs with schemas (Zod/Yup/Joi)",
      "scope": "component",
      "severity": "warning",
      "detection": {
        "patterns": ["<form", "onSubmit"],
        "astHints": ["zod", "yup", "joi"]
      },
      "recommendation": "Use react-hook-form with Zod/Yup for validation and surface errors in UI"
    },
    {
      "id": "sentry-integration",
      "title": "Instrument error tracking",
      "intent": "Capture runtime errors with Sentry or equivalent",
      "scope": "project",
      "severity": "warning",
      "detection": {
        "patterns": ["@sentry/react", "@sentry/browser", "Sentry.init"]
      },
      "recommendation": "Install and configure Sentry across app entry points"
    },
    {
      "id": "husky-precommit",
      "title": "Enforce pre-commit hooks",
      "intent": "Run lint/format/tests on staged files via Husky + lint-staged",
      "scope": "project",
      "severity": "info",
      "detection": {
        "fileGlobs": [".husky/pre-commit", "package.json"],
        "patterns": ["husky", "lint-staged"]
      },
      "recommendation": "Configure Husky pre-commit hook to run lint-staged"
    },
    {
      "id": "react-useeffect-cleanup",
      "title": "Cleanup in useEffect",
      "intent": "useEffect must return a cleanup function to prevent memory leaks and side effects.",
      "scope": "function",
      "severity": "warning",
      "detection": {
        "astHints": ["useEffect", "addEventListener", "subscribe", "setTimeout", "setInterval"]
      },
      "recommendation": "Return a cleanup function from useEffect that removes event listeners, clears timers, or unsubscribes."
    },
    {
      "id": "react-useeffect-dependencies",
      "title": "Specify useEffect Dependencies",
      "intent": "useEffect must have a dependency array to control when it runs.",
      "scope": "function",
      "severity": "error",
      "detection": {
        "patterns": ["useEffect\\(.*\\)(?!.*\\[)"]
      },
      "recommendation": "Add a dependency array as the second argument to useEffect. Use an empty array [] for effects that run once."
    },
    {
      "id": "react-no-inline-objects-in-props",
      "title": "Avoid Inline Objects in Props",
      "intent": "Inline objects cause unnecessary re-renders of child components.",
      "scope": "component",
      "severity": "warning",
      "detection": {
        "patterns": ["<.*\\{\\s*\\{[^}]+\\}\\s*\\}"]
      },
      "recommendation": "Define objects outside the JSX or use useMemo to memoize the object."
    },
    {
      "id": "react-no-inline-functions-in-props",
      "title": "Avoid Inline Functions in Props",
      "intent": "Inline function definitions cause child components to re-render unnecessarily.",
      "scope": "component",
      "severity": "warning",
      "detection": {
        "patterns": ["=\\{\\s*\\(.*\\)\\s*=>", "onClick=\\{\\(.*\\)\\s*=>"]
      },
      "recommendation": "Extract functions or use useCallback to memoize callbacks passed as props."
    },
    {
      "id": "react-avoid-prop-drilling",
      "title": "Avoid Prop Drilling",
      "intent": "Passing props through multiple levels creates tight coupling and makes refactoring difficult.",
      "scope": "component",
      "severity": "warning",
      "detection": {
        "astHints": ["props", "spread-props"]
      },
      "recommendation": "Use Context API, state management library (Zustand, Redux), or component composition to avoid prop drilling."
    },
    {
      "id": "react-extract-custom-hooks",
      "title": "Extract Custom Hooks for Reusable Logic",
      "intent": "Custom hooks extract reusable stateful logic and make components simpler.",
      "scope": "component",
      "severity": "info",
      "detection": {
        "patterns": ["useState.*useState.*useState", "useEffect.*useEffect.*useEffect"]
      },
      "recommendation": "Extract complex logic into a custom hook with a 'use' prefix (e.g., useForm, useFetch)."
    },
    {
      "id": "react-use-memo-for-expensive-calculations",
      "title": "Use useMemo for Expensive Calculations",
      "intent": "useMemo caches expensive computations and prevents unnecessary recalculations.",
      "scope": "component",
      "severity": "warning",
      "detection": {
        "astHints": ["forEach", "filter", "map", "reduce", "sort"]
      },
      "recommendation": "Wrap expensive calculations in useMemo with appropriate dependencies."
    },
    {
      "id": "react-use-callback-for-optimized-children",
      "title": "Use useCallback for Child Optimization",
      "intent": "useCallback memoizes function references to prevent child re-renders when combined with React.memo.",
      "scope": "function",
      "severity": "info",
      "detection": {
        "patterns": ["React\\.memo", "memo\\("]
      },
      "recommendation": "Wrap callback functions passed to memoized children with useCallback."
    },
    {
      "id": "react-use-react-memo",
      "title": "Memoize Expensive Components",
      "intent": "React.memo prevents re-renders of components that receive the same props.",
      "scope": "component",
      "severity": "info",
      "detection": {
        "astHints": ["render-function", "deeply-nested-component"]
      },
      "recommendation": "Wrap expensive components with React.memo when they receive stable props."
    },
    {
      "id": "react-lazy-load-with-suspense",
      "title": "Use React.lazy and Suspense for Code Splitting",
      "intent": "Code splitting reduces bundle size and improves initial load time.",
      "scope": "component",
      "severity": "info",
      "detection": {
        "patterns": ["import.*from.*\\.js", "import.*from.*\\.tsx"]
      },
      "recommendation": "Use React.lazy() for route-based or heavy components and wrap with <Suspense>."
    },
    {
      "id": "react-avoid-dangerously-set-inner-html",
      "title": "Avoid dangerouslySetInnerHTML",
      "intent": "dangerouslySetInnerHTML is a security risk and should be avoided.",
      "scope": "component",
      "severity": "error",
      "detection": {
        "patterns": ["dangerouslySetInnerHTML"]
      },
      "recommendation": "Find alternative approaches or sanitize HTML with a library like DOMPurify before using dangerouslySetInnerHTML."
    },
    {
      "id": "react-sanitize-user-input",
      "title": "Sanitize User Input",
      "intent": "Prevent XSS attacks by sanitizing user input before rendering.",
      "scope": "component",
      "severity": "error",
      "detection": {
        "patterns": ["value.*input", "value.*textarea"]
      },
      "recommendation": "Validate and sanitize all user input using libraries like DOMPurify or sanitize-html."
    },
    {
      "id": "react-env-prefix-validation",
      "title": "Use REACT_APP_ Prefix for Environment Variables",
      "intent": "Only variables prefixed with REACT_APP_ are exposed to the client in Create React App.",
      "scope": "component",
      "severity": "warning",
      "detection": {
        "patterns": ["process\\.env\\.(?!REACT_APP_)"]
      },
      "recommendation": "Prefix environment variables with REACT_APP_ or use a backend service to access private variables."
    },
    {
      "id": "react-no-secrets-in-client",
      "title": "Never Store Secrets in Client Code",
      "intent": "API keys, tokens, and secrets must never be stored in client-side code.",
      "scope": "component",
      "severity": "error",
      "detection": {
        "patterns": ["api[_-]?key", "secret", "token"]
      },
      "recommendation": "Store sensitive data in environment variables on the server and access via backend APIs."
    },
    {
      "id": "react-use-keys-in-lists",
      "title": "Use Keys in Lists",
      "intent": "Keys help React identify which items have changed, improving performance and preventing bugs.",
      "scope": "component",
      "severity": "error",
      "detection": {
        "patterns": ["\\.map\\(.*=>.*<", "key=\\{index\\}"]
      },
      "recommendation": "Use unique, stable identifiers (IDs) as keys in list items. Never use array indices as keys."
    },
    {
      "id": "react-prefer-composition",
      "title": "Prefer Component Composition Over Inheritance",
      "intent": "React emphasizes composition patterns over inheritance for better code organization.",
      "scope": "component",
      "severity": "warning",
      "detection": {
        "patterns": ["extends", "HOC.*props"]
      },
      "recommendation": "Use component composition, render props, or custom hooks instead of higher-order components or inheritance."
    },
    {
      "id": "react-use-context-for-global-state",
      "title": "Use Context for Global State",
      "intent": "Context API is the built-in way to share state across deeply nested components.",
      "scope": "project",
      "severity": "info",
      "detection": {
        "patterns": ["prop-drilling", "multiple-levels-of-props"]
      },
      "recommendation": "Use React Context API or a state management library (Zustand, Redux) for global state."
    },
    {
      "id": "react-use-query-for-server-state",
      "title": "Use TanStack Query for Server State",
      "intent": "TanStack Query (React Query) is the best way to manage server state with caching and synchronization.",
      "scope": "component",
      "severity": "info",
      "detection": {
        "astHints": ["useEffect", "fetch", "axios"]
      },
      "recommendation": "Use @tanstack/react-query or SWR for fetching, caching, and syncing server data."
    },
    {
      "id": "react-custom-hook-naming",
      "title": "Name Custom Hooks with 'use' Prefix",
      "intent": "Custom hooks must be named with 'use' prefix so React can apply the rules of hooks.",
      "scope": "function",
      "severity": "error",
      "detection": {
        "patterns": ["function [a-z][a-zA-Z]*\\(.*\\).*useState", "function [a-z][a-zA-Z]*\\(.*\\).*useEffect"]
      },
      "recommendation": "Rename custom hook functions to start with 'use' (e.g., useFetch, useFormValidation)."
    },
    {
      "id": "react-routing-libraries",
      "title": "Use React Router or Similar Library",
      "intent": "Declarative routing improves code maintainability and enables features like lazy loading.",
      "scope": "project",
      "severity": "warning",
      "detection": {
        "patterns": ["window.location", "window.history"]
      },
      "recommendation": "Use React Router v6+, Wouter, or Reach Router for client-side routing. Enable lazy loading of routes."
    },
    {
      "id": "react-lazy-load-routes",
      "title": "Lazy Load Route Components",
      "intent": "Code splitting routes reduces initial bundle size.",
      "scope": "component",
      "severity": "info",
      "recommendation": "Use React.lazy() and Suspense to lazy load route components."
    },
    {
      "id": "react-data-fetching-best-practices",
      "title": "Use Query Libraries for Data Fetching",
      "intent": "Query libraries (TanStack Query, SWR) provide caching, synchronization, and error handling out of the box.",
      "scope": "component",
      "severity": "warning",
      "detection": {
        "patterns": ["useEffect.*fetch", "useEffect.*axios"]
      },
      "recommendation": "Avoid fetching data in useEffect. Use @tanstack/react-query, SWR, or RTK Query instead."
    },
    {
      "id": "react-state-management",
      "title": "Choose Appropriate State Management",
      "intent": "Use local, context, or global state management based on scope and complexity.",
      "scope": "component",
      "severity": "info",
      "recommendation": "Use useState for local state, Context API for moderate scope, Zustand/Redux for complex global state."
    },
    {
      "id": "react-styling-approach",
      "title": "Choose a Consistent Styling Approach",
      "intent": "Consistent styling improves maintainability.",
      "scope": "project",
      "severity": "info",
      "recommendation": "Use CSS Modules, Styled Components, Emotion, Tailwind CSS, or SASS. Avoid inline styles except for dynamic values."
    },
    {
      "id": "react-css-variables-for-theming",
      "title": "Use CSS Variables for Theming",
      "intent": "CSS Variables enable easy theme switching and maintainable design systems.",
      "scope": "style",
      "severity": "info",
      "recommendation": "Use CSS custom properties (variables) for colors, spacing, and other design tokens."
    },
    {
      "id": "react-responsive-design",
      "title": "Use Mobile-First Responsive Design",
      "intent": "Mobile-first design ensures good user experience across devices.",
      "scope": "style",
      "severity": "warning",
      "recommendation": "Start with mobile layouts and progressively enhance for larger screens using media queries."
    },
    {
      "id": "react-bundling-optimization",
      "title": "Optimize Bundle Size",
      "intent": "Smaller bundles improve load times and user experience.",
      "scope": "project",
      "severity": "warning",
      "recommendation": "Use tree shaking, code splitting, lazy loading, and minimize external dependencies."
    },
    {
      "id": "react-vite-webpack-optimization",
      "title": "Configure Build Tool Properly",
      "intent": "Proper bundler configuration improves performance.",
      "scope": "project",
      "severity": "info",
      "recommendation": "Use Vite for new projects or configure Webpack with code splitting and minification."
    },
    {
      "id": "react-testing-strategy",
      "title": "Implement Comprehensive Testing",
      "intent": "Testing ensures code reliability.",
      "scope": "project",
      "severity": "warning",
      "recommendation": "Use Vitest or Jest with React Testing Library. Test user behavior, not implementation details."
    },
    {
      "id": "react-testing-library-usage",
      "title": "Use React Testing Library Over Enzyme",
      "intent": "React Testing Library encourages testing from the user's perspective.",
      "scope": "project",
      "severity": "warning",
      "detection": {
        "patterns": ["enzyme", "shallow", "mount"]
      },
      "recommendation": "Use React Testing Library for component testing to test behavior, not implementation."
    },
    {
      "id": "react-accessibility-best-practices",
      "title": "Follow Accessibility Guidelines",
      "intent": "Ensure applications are accessible to all users.",
      "scope": "component",
      "severity": "warning",
      "recommendation": "Use semantic HTML, ARIA labels, keyboard navigation, and follow WCAG guidelines. Use tools like axe or Lighthouse for audits."
    },
    {
      "id": "react-semantic-html",
      "title": "Use Semantic HTML Elements",
      "intent": "Semantic HTML improves accessibility and SEO.",
      "scope": "component",
      "severity": "warning",
      "detection": {
        "patterns": ["<div.*onClick", "<div.*role="]
      },
      "recommendation": "Use semantic elements (<button>, <a>, <form>, <input>, etc.) instead of divs with click handlers."
    },
    {
      "id": "react-aria-labels",
      "title": "Provide ARIA Labels When Needed",
      "intent": "ARIA labels help assistive technologies understand content.",
      "scope": "component",
      "severity": "info",
      "recommendation": "Add aria-label or aria-labelledby to elements that lack visible labels."
    },
    {
      "id": "react-keyboard-navigation",
      "title": "Ensure Keyboard Navigation",
      "intent": "Keyboard navigation is essential for accessibility.",
      "scope": "component",
      "severity": "warning",
      "recommendation": "Ensure interactive elements are keyboard accessible. Use tabIndex, onKeyDown handlers, and focus management."
    },
    {
      "id": "react-color-contrast",
      "title": "Maintain Adequate Color Contrast",
      "intent": "Good color contrast ensures readability for users with visual impairments.",
      "scope": "style",
      "severity": "warning",
      "recommendation": "Ensure WCAG AA or AAA color contrast ratios. Use tools like WebAIM contrast checker."
    },
    {
      "id": "react-image-alt-text",
      "title": "Always Provide Alt Text for Images",
      "intent": "Alt text is essential for screen readers.",
      "scope": "component",
      "severity": "error",
      "detection": {
        "patterns": ["<img(?![^>]*alt=)"]
      },
      "recommendation": "Add meaningful alt text to all images. Use alt=\"\" for decorative images."
    },
    {
      "id": "react-form-labels",
      "title": "Associate Labels with Form Inputs",
      "intent": "Labels help users understand form fields.",
      "scope": "component",
      "severity": "warning",
      "detection": {
        "patterns": ["<input", "<select", "<textarea"]
      },
      "recommendation": "Use <label> with htmlFor or aria-label to associate labels with form fields."
    },
    {
      "id": "react-error-boundaries",
      "title": "Use Error Boundaries",
      "intent": "Error boundaries catch errors and prevent app crashes.",
      "scope": "component",
      "severity": "warning",
      "recommendation": "Wrap components with Error Boundary to gracefully handle errors."
    },
    {
      "id": "react-performance-monitoring",
      "title": "Monitor Performance Metrics",
      "intent": "Track and optimize performance.",
      "scope": "project",
      "severity": "info",
      "recommendation": "Use Web Vitals, React DevTools Profiler, or tools like Sentry for performance monitoring."
    }
  ]
}
