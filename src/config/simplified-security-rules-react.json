{
  "meta": {
    "framework": "React",
    "version": "2025.1",
    "type": "simplified-security-config",
    "description": "SIMPLIFIED SECURITY RULES - Modify this file only. Rules are auto-generated to rules/ directory.",
    "instructions": "Edit rules below, then run: npm run generate:rules"
  },
  "rules": [
    {
      "id": "xss-prevention",
      "title": "Prevent XSS Vulnerabilities",
      "enabled": true,
      "severity": "critical",
      "category": "security",
      "patterns": [
        "dangerouslySetInnerHTML",
        "innerHTML",
        "eval\\s*\\(",
        "Function\\s*\\("
      ],
      "recommendation": "Avoid using dangerouslySetInnerHTML. React escapes content by default. Use DOMPurify for user-generated HTML.",
      "codeExample": {
        "bad": "return <div dangerouslySetInnerHTML={{ __html: userInput }} />;",
        "good": "return <div>{userInput}</div>; // React auto-escapes"
      }
    },
    {
      "id": "no-hardcoded-secrets",
      "title": "No Hardcoded Secrets",
      "enabled": true,
      "severity": "critical",
      "category": "security",
      "patterns": [
        "password\\s*[=:]\\s*['\\\"]",
        "api[_-]?key\\s*[=:]\\s*['\\\"]",
        "secret\\s*[=:]\\s*['\\\"]",
        "token\\s*[=:]\\s*['\\\"]"
      ],
      "excludePatterns": [
        "*.test.*",
        "*.spec.*",
        "mock*"
      ],
      "recommendation": "Store all secrets in environment variables. Never commit secrets to version control.",
      "codeExample": {
        "bad": "const apiKey = 'sk-1234567890abcdef';",
        "good": "const apiKey = process.env.REACT_APP_API_KEY;"
      }
    },
    {
      "id": "no-eval",
      "title": "Avoid eval() and Dynamic Code Execution",
      "enabled": true,
      "severity": "critical",
      "category": "security",
      "patterns": [
        "\\beval\\s*\\(",
        "\\bFunction\\s*\\(",
        "setTimeout\\s*\\(['\\\"]",
        "setInterval\\s*\\(['\\\"]"
      ],
      "recommendation": "Never use eval() or Function() constructor. Use JSON.parse or data-driven approaches instead.",
      "codeExample": {
        "bad": "const result = eval(userInput);",
        "good": "const result = JSON.parse(userInput);"
      }
    },
    {
      "id": "secure-api-calls",
      "title": "Secure API Communication",
      "enabled": true,
      "severity": "high",
      "category": "security",
      "patterns": [
        "fetch\\s*\\(\\s*['\\\"]http://",
        "axios\\s*\\(\\s*['\\\"]http://"
      ],
      "recommendation": "Always use HTTPS for API calls. Include proper authentication headers.",
      "codeExample": {
        "bad": "fetch('http://api.example.com/data');",
        "good": "fetch('https://api.example.com/data', {\n  headers: { 'Authorization': `Bearer ${token}` }\n});"
      }
    },
    {
      "id": "csrf-protection",
      "title": "CSRF Token Validation",
      "enabled": true,
      "severity": "high",
      "category": "security",
      "recommendation": "Implement CSRF tokens for state-changing operations. Validate tokens on the server.",
      "codeExample": {
        "bad": "// Form without CSRF protection",
        "good": "// Include CSRF token in forms: <input name='csrf' value={csrfToken} />"
      }
    },
    {
      "id": "input-validation",
      "title": "Input Validation",
      "enabled": true,
      "severity": "high",
      "category": "security",
      "recommendation": "Validate and sanitize all user inputs on both client and server side.",
      "codeExample": {
        "bad": "const userEmail = request.body.email;",
        "good": "const userEmail = sanitize(request.body.email); // Validate format"
      }
    },
    {
      "id": "dependency-vulnerabilities",
      "title": "Check for Vulnerable Dependencies",
      "enabled": true,
      "severity": "high",
      "category": "security",
      "recommendation": "Regularly run npm audit and update vulnerable packages. Use dependabot for automated updates.",
      "codeExample": {
        "bad": "// Outdated vulnerable package version",
        "good": "// Run: npm update && npm audit fix"
      }
    },
    {
      "id": "secure-headers",
      "title": "HTTP Security Headers",
      "enabled": true,
      "severity": "high",
      "category": "security",
      "recommendation": "Implement security headers: CSP, X-Frame-Options, X-Content-Type-Options, Strict-Transport-Security.",
      "codeExample": {
        "bad": "// No security headers",
        "good": "// Add to next.config.js: headers with CSP and other security headers"
      }
    },
    {
      "id": "sql-injection",
      "title": "SQL Injection Prevention",
      "enabled": true,
      "severity": "critical",
      "category": "security",
      "patterns": [
        "query\\s*\\(\\s*['\\\"].*\\+.*['\\\"]",
        "execute\\s*\\(\\s*['\\\"].*\\+.*['\\\"]"
      ],
      "recommendation": "Use parameterized queries or ORM libraries. Never concatenate user input into SQL strings.",
      "codeExample": {
        "bad": "db.query(`SELECT * FROM users WHERE id = ${userId}`);",
        "good": "db.query('SELECT * FROM users WHERE id = ?', [userId]);"
      }
    },
    {
      "id": "authentication-checks",
      "title": "Authentication & Authorization",
      "enabled": true,
      "severity": "critical",
      "category": "security",
      "recommendation": "Verify authentication before accessing protected resources. Check user permissions for authorization.",
      "codeExample": {
        "bad": "if (user) { /* allow access */ }",
        "good": "if (user && user.role === 'admin') { /* allow access */ }"
      }
    }
  ]
}
